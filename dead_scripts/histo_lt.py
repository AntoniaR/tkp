#!/usr/bin/python

import pylab

x_bg = [181, 173, 171, 198, 200, 179, 159, 151, 172, 174, 177, 178, 190, 178, 192, 175, 194, 184, 182, 201, 211, 184, 180, 170, 157, 217, 213, 196, 206, 215, 208, 199, 201, 222, 219, 201, 188, 213, 210, 194, 219, 209, 211, 208, 228, 230, 210, 219, 208, 222, 203, 260, 194, 218, 221, 221, 219, 248, 244, 245, 231, 262, 221, 247, 247, 254, 241, 266, 232, 240, 243, 234, 286, 244, 264, 274, 254, 286, 266, 275, 286, 275, 265, 292, 304, 302, 299, 328, 317, 265, 293, 315, 329, 313, 328, 309, 341, 333, 345, 344, 350, 338, 351, 352, 323, 357, 353, 342, 340, 324, 358, 354, 412, 383, 369, 403, 381, 380, 377, 391, 408, 394, 431, 412, 414, 358, 473, 440, 414, 422, 429, 450, 432, 438, 476, 459, 435, 489, 459, 474, 449, 459, 434, 496, 541, 508, 535, 508, 515, 591, 513, 545, 584, 542, 610, 565, 643, 605, 620, 720, 635, 674, 746, 730, 738, 771, 823, 841, 848, 901, 961, 1025, 1016, 1045, 1146, 1241, 1257, 1222, 1364, 1481, 1563, 1518, 1725, 1812, 1924, 2110, 2268, 2362, 2514, 2537, 2677, 2790, 3111, 3240, 3449, 3479, 3565, 3705, 3879, 3816, 3970, 3937, 4357, 4451, 4241, 3697, 1731, 413, 144, 27]

bins_bg = [-100.0, -99.5, -99.0, -98.5, -98.0, -97.5, -97.0, -96.5, -96.0, -95.5, -95.0, -94.5, -94.0, -93.5, -93.0, -92.5, -92.0, -91.5, -91.0, -90.5, -90.0, -89.5, -89.0, -88.5, -88.0, -87.5, -87.0, -86.5, -86.0, -85.5, -85.0, -84.5, -84.0, -83.5, -83.0, -82.5, -82.0, -81.5, -81.0, -80.5, -80.0, -79.5, -79.0, -78.5, -78.0, -77.5, -77.0, -76.5, -76.0, -75.5, -75.0, -74.5, -74.0, -73.5, -73.0, -72.5, -72.0, -71.5, -71.0, -70.5, -70.0, -69.5, -69.0, -68.5, -68.0, -67.5, -67.0, -66.5, -66.0, -65.5, -65.0, -64.5, -64.0, -63.5, -63.0, -62.5, -62.0, -61.5, -61.0, -60.5, -60.0, -59.5, -59.0, -58.5, -58.0, -57.5, -57.0, -56.5, -56.0, -55.5, -55.0, -54.5, -54.0, -53.5, -53.0, -52.5, -52.0, -51.5, -51.0, -50.5, -50.0, -49.5, -49.0, -48.5, -48.0, -47.5, -47.0, -46.5, -46.0, -45.5, -45.0, -44.5, -44.0, -43.5, -43.0, -42.5, -42.0, -41.5, -41.0, -40.5, -40.0, -39.5, -39.0, -38.5, -38.0, -37.5, -37.0, -36.5, -36.0, -35.5, -35.0, -34.5, -34.0, -33.5, -33.0, -32.5, -32.0, -31.5, -31.0, -30.5, -30.0, -29.5, -29.0, -28.5, -28.0, -27.5, -27.0, -26.5, -26.0, -25.5, -25.0, -24.5, -24.0, -23.5, -23.0, -22.5, -22.0, -21.5, -21.0, -20.5, -20.0, -19.5, -19.0, -18.5, -18.0, -17.5, -17.0, -16.5, -16.0, -15.5, -15.0, -14.5, -14.0, -13.5, -13.0, -12.5, -12.0, -11.5, -11.0, -10.5, -10.0, -9.5, -9.0, -8.5, -8.0, -7.5, -7.0, -6.5, -6.0, -5.5, -5.0, -4.5, -4.0, -3.5, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5]

dist_bg = [66.297044988364377, 67.75677922218793, 65.520147726048449, 64.234786326447349, 62.667897152545684, 62.351743480236131, 64.651019512861097, 62.897352658631434, 64.296651178713844, 65.736655362104443, 63.048947577102325, 65.744222163598877, 62.051388466415027, 64.235313262888383, 64.424004369168713, 62.546687868613205, 62.863477935011616, 63.452933806763696, 61.825183880561518, 64.706327560379862, 62.518489827293969, 61.632198219528838, 65.25761738552832, 64.809787005505655, 63.493004814121768, 62.759401265825879, 64.06963636450493, 63.289933092335858, 64.08569150434775, 63.281700995284254, 61.640051482914188, 62.775296064098931, 64.026255256745955, 62.990052434952517, 62.282019373786625, 64.025117748584194, 63.099870654647042, 63.605320816461756, 61.308778707717309, 64.949994795215432, 62.905609342329775, 63.400265254972012, 62.330680277647225, 62.663847138479426, 63.306123047251866, 61.748895881695177, 63.60441242629436, 63.995218035500237, 60.59987676977309, 61.648768413249137, 60.983465107218393, 62.696565625357941, 61.603592408686438, 63.347849184228707, 63.535493962870426, 61.655179036648185, 62.252353224285038, 62.362388171067856, 62.012303773954677, 61.696066115665452, 63.107320274838735, 61.109067967600332, 62.507935203103948, 62.662758001200075, 64.102539050829506, 60.36125319888945, 63.594972130272481, 63.485078226868687, 62.34599238854809, 62.981655099108956, 63.317972048269901, 62.680206739444223, 61.722462966516247, 61.082924016983768, 61.648262355892847, 63.306055361094515, 61.989416670591616, 62.775877511540088, 61.872242252507903, 62.158904308278686, 62.399980049782471, 62.453478195024651, 62.449203326913292, 62.203899197415389, 61.581278681443038, 61.777707486242385, 63.31537931282557, 63.099099931815203, 62.376459048675954, 63.722361204846123, 61.973612481695255, 63.47442523947467, 62.010484838253134, 62.634511767976868, 63.555236329980012, 62.863174104644727, 62.321815668384417, 62.390071165067233, 62.102147708320729, 61.873581685736205, 61.846583791184614, 61.535692370581387, 62.335958633718711, 61.92781298356612, 61.625932971911979, 62.185548245185423, 62.580884406226282, 61.893748747471228, 62.767050500803229, 61.194091750540387, 61.96339635548091, 61.349301685837652, 61.65462701907272, 61.45987998909969, 61.442721205787073, 61.812245538733684, 59.237626777619411, 61.36855783647885, 60.323193590837334, 61.352924609486237, 62.026365535894008, 60.889692432573923, 59.47233340349193, 60.245985335264528, 61.507105770008607, 59.308914592695572, 59.380175716593733, 60.936225482861424, 59.522746518606361, 59.166223714844399, 58.174501957224443, 59.093944465095497, 58.927153324199331, 57.916044761337425, 57.409949892108052, 60.026047325997247, 57.622511380701411, 58.134972310367004, 58.24599163604487, 59.364407339945643, 58.465381649019506, 57.780467248831854, 58.1605976140415, 59.241953692703682, 57.730082870767419, 59.846551550564357, 58.386577103463068, 59.191711594589734, 57.426913967037684, 59.013650450389129, 58.659665352742124, 58.474177400035913, 59.813416874481881, 58.896251264073484, 57.628131123292192, 57.853423238854802, 56.926300119174876, 58.064193035417908, 59.087246486881405, 58.8758321261042, 59.113695348840579, 59.5755358279511, 59.382570921728423, 59.420966494084219, 59.850598891402996, 58.374275076124498, 61.000510411744067, 61.050459624806344, 60.563038148310156, 61.388683106368433, 61.920797860127571, 62.432473020905142, 62.115301959404931, 63.970713367692234, 62.860948633624282, 64.12509485079336, 63.793840841184519, 64.597419021202725, 64.499417585965489, 64.059894422290583, 65.632426811193866, 65.139430833216679, 65.59718751376424, 65.902606061711012, 66.007767740914403, 66.359060604217731, 65.814193381719647, 65.643325512258443, 65.567452461455176, 64.873020873381137, 64.183390456930354, 63.399055229645036, 63.262659961766566, 61.946605875260389, 60.924732651578474, 59.695360623912336, 57.471706674323606, 55.59289643449349, 53.662519867949442, 51.231442300436044, 47.504954159463509, 44.606805038823389, 41.450270048956291, 35.551565527082097, 26.072289323404171, 16.568351960509066, 8.5676171082885446, 4.9191724666981953, 2.9745448302301685, 1.2504476091146091]

x_src = [67, 60, 54, 58, 60, 62, 55, 52, 60, 55, 49, 50, 61, 47, 54, 71, 65, 53, 61, 67, 71, 74, 74, 65, 63, 61, 58, 74, 57, 81, 65, 72, 62, 59, 81, 78, 76, 61, 70, 70, 78, 83, 73, 82, 70, 56, 81, 86, 78, 80, 71, 64, 75, 83, 80, 81, 77, 70, 82, 80, 90, 80, 68, 85, 84, 81, 90, 82, 97, 84, 76, 86, 70, 99, 83, 83, 97, 92, 98, 92, 86, 83, 82, 89, 80, 86, 86, 95, 94, 101, 112, 94, 105, 103, 111, 98, 119, 96, 115, 112, 104, 118, 118, 88, 144, 101, 111, 98, 114, 114, 111, 111, 110, 109, 118, 99, 99, 116, 109, 113, 100, 110, 126, 142, 135, 91, 117, 125, 119, 103, 118, 134, 122, 110, 127, 138, 125, 129, 140, 125, 134, 127, 129, 142, 140, 135, 139, 118, 149, 146, 149, 163, 148, 163, 138, 182, 143, 151, 150, 159, 148, 179, 174, 187, 175, 189, 180, 169, 196, 206, 198, 220, 212, 217, 244, 222, 234, 254, 246, 243, 318, 303, 310, 346, 333, 381, 396, 458, 441, 485, 497, 568, 608, 681, 729, 830, 967, 1064, 1255, 1534, 1820, 2442, 3343, 5029, 8498, 27504, 60143, 22614, 38666, 43274]

dist_src = [58.873623478821081, 59.093586730115824, 59.884989177382643, 57.831581614073784, 59.138348938887923, 57.547412184391987, 58.273792116926451, 58.914894743515859, 56.528653344363626, 59.573385412809188, 56.647891275703842, 54.628841276878568, 60.421285123071058, 59.123448155949795, 55.707191765766176, 58.888393623471003, 56.596134260894253, 56.380148233259462, 56.229637455617969, 55.080759575222125, 57.485464890490086, 57.231634539041153, 55.874536231467474, 56.481630962882285, 58.021966464831678, 54.326027428644593, 59.597712904618682, 59.309034559609614, 56.944385419449461, 55.450091494056785, 55.701419255847817, 57.95408387666857, 56.377409010348138, 59.257915270811409, 56.119973702183742, 57.605524961154138, 56.746194844676268, 53.822185564398318, 55.727911880615167, 55.6691365073276, 57.419283642281641, 55.461036687466731, 54.927257103749561, 52.821069837208078, 56.405370030286569, 53.987290408513921, 54.989393009263715, 54.743494659363371, 56.252861776822279, 55.030993735037768, 53.642402969224904, 53.171239426646778, 53.338267754496712, 53.872474256460052, 52.461429262157388, 54.135733353367456, 52.819073555654278, 53.161371319394313, 53.276485086684374, 54.536492835273272, 55.675708469145967, 53.846781400264874, 51.460612759869846, 56.085988266695217, 52.62826796395283, 53.131688772230291, 53.653021749896006, 52.641516843734216, 50.488479573589849, 55.244979607827815, 54.753591853934758, 53.245767534439246, 50.377957257368458, 51.52285590197755, 50.960431526943935, 49.541591303850403, 49.630168306280424, 49.569955093428611, 51.566097122375922, 48.573737382943946, 50.765590363498227, 48.889415867908909, 51.23830222323609, 51.879714784356374, 49.980252399948782, 55.427146962902214, 52.478893116761597, 48.586803250247776, 50.506099039160041, 49.950018645402203, 49.667861252696206, 48.696818390662479, 46.153396491985596, 47.770212139163512, 47.724342189322471, 48.31479150833318, 47.625142940827473, 50.505654133171809, 48.74998529778135, 47.433902556865647, 45.41160358023523, 49.451944189474894, 48.293726500177122, 44.651851536331591, 45.416854206774929, 46.411443901148267, 47.006194246532168, 44.395640604141086, 44.739887147528108, 46.847130656558299, 46.29845307238179, 46.386456143956629, 45.983102255269806, 47.106997186526655, 49.647550842382778, 40.996516935424687, 47.232735732271557, 45.476659053758951, 41.825524152956461, 47.496336282271535, 42.919253085247128, 40.653423331359242, 43.684833256159443, 43.900908638309069, 42.040216440256572, 41.692423505778748, 43.307715330983278, 37.969312619810665, 41.249155246270234, 42.601526114037263, 41.402623561668122, 41.544548621364882, 37.800562643772864, 40.985171710675239, 39.340712581736049, 39.834036996016685, 37.679257080114837, 42.730261904287296, 38.042496989588308, 39.759366149258817, 38.232103531076895, 36.552263492606748, 40.683665212477607, 39.60295675281678, 39.675291291587754, 38.536851771379688, 39.241628786681119, 38.433868247716873, 37.002799364186501, 36.56156905480065, 37.789795324665235, 34.188049252689247, 36.828998584712302, 36.041694095510678, 36.097657100312233, 38.238726368265588, 36.121265307660281, 37.184841918157268, 36.4172272372533, 37.258065297306658, 41.42792006812757, 37.967931248386684, 36.218819345255234, 36.389756512841117, 36.024162883157615, 40.864800861557654, 38.700199400502427, 41.663843259639897, 38.798008187518278, 40.679723837127852, 40.263860579132015, 42.200331236707186, 40.721588277042443, 42.638055215526656, 43.561158201839895, 44.438322706426284, 41.780016693454691, 45.980714665798502, 44.058931977219665, 42.840259365866523, 45.184723203384955, 46.208288605832124, 47.606305721051456, 44.572010915900961, 49.460826404994954, 44.473030626587828, 48.154291042400722, 48.059516244488947, 47.255899490982785, 47.205720070139492, 47.909137436961508, 44.364479829421995, 43.17293948856625, 42.617536879074713, 38.98302676887743, 39.16336570080982, 34.817445913404974, 35.821771355828737, 31.570498926935439, 30.388312672886546, 28.096574162487549, 25.365755100050841, 24.447643164249563, 22.392156658729103, 18.89179029667347, 12.993335751345887, 6.7409049793061788, 4.2610782378305494, 2.9298709049403997, 1.2395084823021689]


width = 1./len(x_bg)

x_bg_mut = []
x_src_mut = []
for i in range(len(bins_bg)):
    for j in range(x_bg[i]):
        x_bg_mut.append(bins_bg[i] + 0.25)
    for k in range(x_src[i]):
        x_src_mut.append(bins_bg[i] + 0.25)

x_div = []
for i in range(len(bins_bg)):
    x_div.append(pylab.log10(float(x_bg[i])/float(x_src[i])))


xt = pylab.arange(min(bins_bg),max(bins_bg),20)

fig = pylab.figure()
ax1 = fig.add_subplot(111)
#ax1.set_xticks(xt)
#ax1.set_xticklabels(xt)
ax1.set_xlabel('log LR')
ax1.set_ylabel('log N (log LR)', color='r')
n,bins,patches = ax1.hist(x_src_mut,bins=bins_bg,edgecolor='r',color='r', histtype='stepfilled',log=True,normed=True)
n,bins,patches = ax1.hist(x_bg_mut,bins=bins_bg,histtype='step',edgecolor='k',log=True,normed=True,hatch='/',linewidth=1)
pylab.grid(True)

ax2 = ax1.twinx()
#ax2.set_xticks((ind+width/2.)[::every])
#ax2.set_xticklabels(bins[::every])
ax2.set_ylabel('distance [arcsec]', color='b')
for tl in ax2.get_yticklabels():
    tl.set_color('b')

#ax2.plot(bins_bg, dist_bg, 'b--', linewidth=1)
#ax2.plot(bins_bg, dist_src, 'b-', linewidth=2)
ax2.plot(bins_bg, x_div, 'b-', linewidth=2)
#ax2.set_yticks([0,10,20,30,40,50,60,70,80,90])
#ax2.set_yticklabels((0,10,20,30,40,50,60,70,80,90))

pylab.show()


